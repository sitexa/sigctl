# 交通信号控制系统说明书

本文档面向目录 `doc/TscSrc` 下的交通信号控制（Traffic Signal Control, TSC）C 语言工程，说明程序的功能、组织方式、技术框架与使用方法，并给出开发与维护建议。

---

## 一、总体概述（程序的功能）
- 本工程是一套用于路口信号控制的模块化 C 项目，目标实现多策略的交通信号控制与联动（定时控制、检测响应、公交优先、半感应、过载保护、黄闪触发、铁路道口、一体化与协调、自适应与时序优化等）。
- 系统采用“主控制器 + 策略模块”的结构：主控负责初始化、调度、状态管理和策略编排；各策略模块独立编译，按需集成。
- 目录 `doc/TscSrc/Bin/` 中包含可执行产物（如 `maincont`），用于在目标平台上运行主控制逻辑。

---

## 二、目录组织与代码结构（组织方式）
顶层目录结构（只列出与本说明相关的关键路径）：

- `doc/TscSrc/Bin/`：最终可执行程序与打包产物（例如 `maincont`）。
- `doc/TscSrc/Inc/`：全局头文件，提供统一的类型、常量、宏定义与接口声明（如 `cy_tsc.h`、`mydef.h`）。
- `doc/TscSrc/Lib/`：公共库目录（当前为空或预留）。
- `doc/TscSrc/Modules/`：核心模块区，每个功能模块均为独立工程，通常包含：
  - `Makefile`：模块独立构建脚本；
  - 源码文件：如 `xxx.c`、`xxx.h`、以及配套的 `xxxs.c`（常见是策略/状态/服务的实现拆分）；
  - 构建输出：`build/`（中间产物）、`dist/`（目标产物）；
  - `.dep.inc` 与 `nbproject/`：依赖与 IDE 工程配置（NetBeans 风格）。
- `doc/TscSrc/libsrc/libsntp/`：SNTP 时间同步静态库源码与 `Makefile`，供主控或时间相关模块链接使用。
- `doc/TscSrc/tags`：ctags 索引文件，便于代码导航。

模块间公共接口通过 `doc/TscSrc/Inc/` 下的头文件统一输出，保证跨模块的一致性与复用。

---

## 三、技术框架与依赖（技术框架）
- 编程语言与范式：标准 C（以 C89/C99 风格为主），模块化设计；公共类型与宏定义集中于 `Inc/`。
- 构建系统与工具链：
  - 各模块使用 GNU Make 独立构建，`Makefile` 位于各模块目录；
  - 工程包含 NetBeans 的 `nbproject/`，可用 IDE 管理或纯命令行构建；
  - 时间同步采用 SNTP：源码位于 `doc/TscSrc/libsrc/libsntp/`；主控模块 `doc/TscSrc/Modules/MainCont/` 中亦包含已编译的 `libnet_sntp.a` 以便直接复用。
- 运行环境与外设：
  - 结合仓库中提供的《英利Linux工控主板使用必读(EM928x)V1.0.pdf》，推断目标平台为 Linux 工控板；亦可在 Linux/macOS 上原生编译或交叉编译。
  - 系统可能与检测器、道闸、CAN 总线等外设交互；仓库根目录提供了 Rust 层 CAN 示例与封装，便于与此 C 工程并行协作。

---

## 四、模块清单与功能定位（按名称推断）
- 主控与通用
  - `Modules/MainCont/`：主控制器（如 `mc.c`、`mcs.c`），负责系统初始化、状态管理、调度与与各策略模块的编排；包含 `libnet_sntp.a`。
  - `Modules/Common/`：公共工具/常量/通用逻辑（`common.c/.h`），为各策略模块提供基础复用能力。

- 关键控制策略
  - `Modules/TimingControl/`：定时控制（`tc.c/tcs.c`），按日计划/相位/周期运行。
  - `Modules/DetectControl/`：检测控制（`dc.c/dcs.c`），对地感、视频等检测信号进行处理与策略触发。
  - `Modules/BusPriority/` 与 `Modules/BusPriority-V1.0/`：公交优先策略（`bus*.c`），存在不同版本并存，集成时需选定其一。
  - `Modules/PersonPassStreet/`：行人过街策略（`pps.c/ppss.c`）。
  - `Modules/MajorHalfDetect/` 与 `Modules/MinorHalfDetect/`：半感应控制（主路/次路）。
  - `Modules/OverLoadControl/`：过载/异常保护（`olc.c/olcs.c`）。
  - `Modules/YellowFlashTrigger/`：黄闪模式触发（`yft.c/yfts.c`）。
  - `Modules/RailCrossControl/`：铁路道口联动控制（`rcc.c/rccs.c`）。

- 自适应/协调/优化
  - `Modules/SelfAdaptControl/`：自适应控制（`sac.c/sacs.c`）。
  - `Modules/SysOptimizeAdapt/`：系统层自适应优化（`soa.c/soas.c`）。
  - `Modules/SysOptimizeTiming/`：时序优化（`sot.c/sots.c`）。
  - 其他：`CoordingDetect/`（协调检测）、`InterGratedControl/`（一体化控制）、`SameControl/`（同向控制）、`BrainSelfAdapt/`、`BrainPersonPassStreet/`（更高阶“Brain”策略等）。

> 注：以上基于目录与文件名的功能定位推断，建议在集成或调试前通读对应模块源码与头文件以确认接口与数据流。

---

## 五、构建与使用方法（使用方法）
### 1) 前置依赖
- GNU Make、gcc/clang（或交叉编译工具链，视目标板而定）。
- 可选：ctags、NetBeans（如需 IDE 工程管理）。

### 2) 按模块独立构建
- 进入某个模块目录执行：`make`
  - 示例：在 `doc/TscSrc/Modules/TimingControl/` 执行 `make`，通常会在 `build/` 生成中间文件，在 `dist/` 生成目标产物（以该模块 Makefile 为准）。
- 建议优先构建 `Common/` 及被其他模块依赖的基础模块。

### 3) 构建 SNTP 库（可选）
- 如需从源码构建时间同步库：进入 `doc/TscSrc/libsrc/libsntp/`，执行 `make` 生成 `libnet_sntp.a`。
- 或直接复用 `doc/TscSrc/Modules/MainCont/libnet_sntp.a`（已提供静态库）。

### 4) 构建主控
- 进入 `doc/TscSrc/Modules/MainCont/` 执行 `make`，链接各策略模块后生成主控产物；产物通常会被上层打包/复制到 `doc/TscSrc/Bin/`。
- 亦可参考 `doc/TscSrc/Modules/compile.sh` 批量构建：该脚本已包含按顺序进入子目录的命令（例如 `cd ./TimingControl` 等），可作为批量构建入口；如需一键化更完善的体验，可在此脚本中补充统一的 `make`/`clean`、错误处理与产物收集逻辑。

### 5) 运行与验证
- 进入 `doc/TscSrc/Bin/`，运行 `./maincont`。
- 注意：在工控板上运行时，可能涉及 GPIO、串口、CAN、时钟同步等硬件权限，需具备 root 或相应 udev 规则；在开发机上可通过仿真/桩件进行策略逻辑验证。

### 6) 清理
- 在各模块目录内执行 `make clean` 清理中间与目标文件。

---

## 六、开发与集成建议
- 统一接口与类型：
  - 在 `doc/TscSrc/Inc/` 中集中定义结构体、常量、错误码、日志宏等，确保跨模块接口一致，避免重复定义（坚持“全局唯一、全局一致，不重复创建”）。
- 依赖与调度：
  - 主控（`MainCont`）是唯一调度入口，各策略模块建议提供统一的 `Init/Start/Step/Stop` 等接口以便编排；
  - 模块内部避免主动循环依赖主控，使用明确回调/接口对接。
- 新增模块流程：
  - 参考功能相近模块作为模板，复制并重命名源码与 `Makefile`；
  - 在 `Inc/` 中新增对外接口头文件；
  - 在主控中完成注册与编译集成。
- 日志与调试：
  - 建议在公共头文件中统一调试宏（如 `DEBUG/INFO/ERROR` 等），模块内以宏控制日志等级，方便定位问题且不影响发布性能。
- 时间同步：
  - 需要网络对时的场景请链接 SNTP 库，主控启动阶段先完成时间对齐，以保证日计划/相位切换按时执行。
- 与 CAN/上层系统对接：
  - 仓库根目录存在 Rust 层的 CAN 示例与封装（如 `examples/can_demo.rs`、`src/io_can.rs`）。如需协作，建议采用清晰的协议与接口边界（共享内存、Unix Socket 或消息队列等），避免双向耦合。

---

## 七、常见问题与注意事项
- 版本并存：
  - 如 `BusPriority/` 与 `BusPriority-V1.0/` 并存，集成时请明确使用哪个版本，并在主控中保持引用唯一性。
- 构建差异：
  - 各模块 `Makefile` 可能存在不同的编译选项（优化级别、警告、目标架构）。交叉编译时建议统一通过环境变量传入 `CC/CFLAGS/LDFLAGS`，避免在 `Makefile` 中硬编码。
- 脚本化构建：
  - `doc/TscSrc/Modules/compile.sh` 可作为批构建入口。若需完善一键构建体验，可按依赖顺序组织：基础/公共模块 → 策略模块 → 主控 → 复制产物到 `Bin/`。
- 平台与权限：
  - 在工控板上运行需关注设备权限与实时性（调度周期、线程优先级、时钟源），在开发环境可放宽。

---

## 八、快速上手清单
1. 阅读 `doc/TscSrc/Inc/cy_tsc.h`、`doc/TscSrc/Inc/mydef.h`，了解全局宏与类型。
2. 选择核心模块（如 `TimingControl`、`DetectControl`、`BusPriority` 等）阅读其 `.h/.c` 与 `Makefile`，确认接口与编译方式。
3. 先构建 `Common` 及所需策略模块，再构建 `MainCont`，运行 `doc/TscSrc/Bin/maincont` 做基础验证。
4. 在测试环境通过桩件或模拟输入验证策略逻辑，再联调实际硬件。

---

## 九、模块分章节说明（按模块分章：功能、技术、使用）

以下按 `doc/TscSrc/Modules/` 下的模块逐一给出：
- 模块功能（做什么）
- 主要源文件（代码组织）
- 对外接口/关键数据（以头文件和状态机为线索）
- 依赖关系（其他模块/库）
- 配置与参数（可调项与运行期参数）
- 编译与产物（如何构建、产物位置）
- 集成与调用（主控如何使用该模块）
- 测试要点（建议的单元/联调要点）
- 扩展点（可演进方向）

为避免重复，通用编译与清理规则同“第五章 构建与使用方法”。若某模块暂未补充具体源码/接口，请以本章节为模板完善。

---

### 9.1 MainCont（主控制器）
- 功能：
  - 系统入口与总调度，完成初始化、时间同步、周期调度、策略编排、故障与异常保护的顶层处理。
- 主要源文件：
  - mc.c、mcs.c、mc-keli.c（如存在平台差异化实现）；静态库 libnet_sntp.a（SNTP）。
- 对外接口/关键数据：
  - 通过 Inc/ 下的全局类型与枚举定义系统状态、相位、方案与日计划；对各策略模块提供注册/回调接口（建议统一 Init/Start/Step/Stop）。
- 依赖关系：
  - Common、TimingControl、DetectControl、以及按需启用的策略模块；SNTP 静态库。
- 配置与参数：
  - 日计划/相位表、策略启用开关、日志级别、对时开关等（建议集中在 Inc/ 或主控配置段）。
- 编译与产物：
  - 进入 Modules/MainCont/ 执行 make，产物复制/打包至 Bin/maincont。
- 集成与调用：
  - 主控在启动时检测已编译策略模块的可用性，按依赖顺序执行初始化；周期性调用 Step/Run 等方法形成主循环。
- 测试要点：
  - 开机流程、时间同步成功率、在不同策略组合下的切换稳定性、异常保护（看门狗/黄闪/全红）。
- 扩展点：
  - 增加插件式策略注册表、运行期启停策略、远程配置下发与持久化。

---

### 9.2 Common（通用组件）
- 功能：
  - 提供通用工具、常量、日志、时间/队列等基础设施能力，供各策略复用。
- 主要源文件：
  - common.c、common.h。
- 对外接口/关键数据：
  - 常用宏、错误码、简单数据结构（环形队列/时间工具）等。
- 依赖关系：
  - 仅依赖 Inc/。
- 配置与参数：
  - 日志开关、调试宏等。
- 编译与产物：
  - 进入 Modules/Common/ 执行 make；目标产物位于 dist/（库或对象，视 Makefile）。
- 集成与调用：
  - 各模块通过包含 common.h 使用公共工具；链接公共对象/库。
- 测试要点：
  - 工具函数正确性、边界条件、时间精度。
- 扩展点：
  - 引入统一日志后端、统计指标采集、参数读取（INI/YAML）。

---

### 9.3 TimingControl（定时控制）
- 功能：
  - 基于时钟/日计划/相位表执行固定配时或基于计划的切换（周期、相序、绿信比）。
- 主要源文件：
  - tc.c、tcs.c、tc-keli.c（平台适配）。
- 对外接口/关键数据：
  - 相位/阶段/方案结构体，定时器回调；对主控暴露计划装载、相序切换、方案切换接口。
- 依赖关系：
  - Common、MainCont（调度驱动）、SNTP（间接）。
- 配置与参数：
  - 日计划、相序表、黄闪/全红时长、相间保护时间。
- 编译与产物：
  - 进入 Modules/TimingControl/ 执行 make；产物位于 dist/。
- 集成与调用：
  - 主控定期调用 Step/Run 推进计时；接收主控发起的方案/相序切换命令。
- 测试要点：
  - 相序/相间时间准确性、跨日切换、与其他策略的优先级冲突处理。
- 扩展点：
  - 多方案按节假日/事件表切换、倒计时对接、与自适应/协调联动。

---

### 9.4 DetectControl（检测控制）
- 功能：
  - 采集检测器（地感、视频等）输入，生成占有率/到达率等指标，触发策略（如半感应、公交优先）。
- 主要源文件：
  - dc.c、dcs.c、dcs.h。
- 对外接口/关键数据：
  - 检测器通道定义、事件/统计报表；对外提供订阅/回调或轮询接口。
- 依赖关系：
  - Common；可能与底层 IO/驱动对接（本仓库外）。
- 配置与参数：
  - 通道映射、滤波参数、占有率阈值/超时时间。
- 编译与产物：
  - Modules/DetectControl/ 执行 make；产物位于 dist/。
- 集成与调用：
  - 主控或策略模块定期读取检测数据或注册事件回调。
- 测试要点：
  - 抖动去除、误触发率、极端流量下的吞吐与实时性。
- 扩展点：
  - 接入更多检测器类型（雷达/融合）、统一抽象层。

---

### 9.5 BusPriority / BusPriority-V1.0（公交优先）
- 功能：
  - 识别公交到达/即将到达，执行绿延长、提前放行、相位插入等优先策略，尽量减少干扰与安全风险。
- 主要源文件：
  - bus.c、buss.c、buss.h（两个版本目录内命名类似）。
- 对外接口/关键数据：
  - 车道与线路配置、优先请求/撤销接口、策略决策结果（延长秒数/插入阶段）。
- 依赖关系：
  - DetectControl（检测）、TimingControl（实施）、Common、MainCont（调度）。
- 配置与参数：
  - 优先等级、最小/最大绿延长、冷却时间、触发阈值。
- 编译与产物：
  - 分别在两个目录执行 make；集成时仅选择一个版本链接，保证“全局唯一”。
- 集成与调用：
  - 主控在检测到公交请求后调用策略评估并向 TimingControl 下发调整。
- 测试要点：
  - 连续请求抑制、与行人/非机动车冲突、极端工况下的安全性。
- 扩展点：
  - 与云端/车路协同（V2X）联动、动态等级调整。

---

### 9.6 PersonPassStreet（行人过街）
- 功能：
  - 处理行人请求按钮/检测，执行行人相位放行与保护期管理。
- 主要源文件：
  - pps.c、ppss.c、ppss.h。
- 对外接口/关键数据：
  - 行人请求队列、最短绿/清退时间、闪烁提示状态。
- 依赖关系：
  - DetectControl、TimingControl、Common。
- 配置与参数：
  - 行人最小绿、清退/缓冲时间、触发节流。
- 编译与产物：
  - Modules/PersonPassStreet/ 执行 make。
- 集成与调用：
  - 主控监听行人请求并协调相序。
- 测试要点：
  - 高频按钮触发下的节流、与机动车相位冲突保护。
- 扩展点：
  - 无障碍/自适应行人清退、夜间策略差异化。

---

### 9.7 MajorHalfDetect / 9.8 MinorHalfDetect（半感应控制）
- 功能：
  - 基于流量检测对主路/次路执行半感应放行与绿时微调，降低空放与排队过长。
- 主要源文件：
  - mhd.c、mhds.c、mhds.h；mih.c、mihs.c、mihs.h。
- 对外接口/关键数据：
  - 车检器占有率/排队长度阈值、相位提前/延后策略。
- 依赖关系：
  - DetectControl、TimingControl、Common。
- 配置与参数：
  - 放行最小绿/最大绿、感应阈值、延长步进。
- 编译与产物：
  - 各自目录执行 make；产物位于 dist/。
- 集成与调用：
  - 主控周期调用评估感应调整并作用于时序模块。
- 测试要点：
  - 低流/高流极端下的稳定性、与公交优先/行人策略冲突时的优先级。
- 扩展点：
  - 与自适应/协调联合优化。

---

### 9.9 OverLoadControl（过载控制）
- 功能：
  - 针对控制器/路口异常（如检测数据异常、设备过载）采取保护策略（降级/黄闪/全红）。
- 主要源文件：
  - olc.c、olcs.c、olc.h。
- 对外接口/关键数据：
  - 异常检测指标、降级级别、恢复策略。
- 依赖关系：
  - Common、MainCont、TimingControl。
- 配置与参数：
  - 触发阈值、降级持续时间、恢复条件。
- 编译与产物：
  - Modules/OverLoadControl/ 执行 make。
- 集成与调用：
  - 主控在异常状态下优先调用保护策略覆盖常规时序。
- 测试要点：
  - 抖动/误报抑制、从降级到恢复的平滑性。
- 扩展点：
  - 引入自愈与告警上报。

---

### 9.10 YellowFlashTrigger（黄闪触发）
- 功能：
  - 在夜间/异常/维护等场景触发黄闪模式并退出。
- 主要源文件：
  - yft.c、yfts.c、yfts.h。
- 对外接口/关键数据：
  - 触发条件、最小持续时长、退出条件。
- 依赖关系：
  - MainCont、TimingControl、Common。
- 配置与参数：
  - 夜间时间窗、手动触发开关。
- 编译与产物：
  - Modules/YellowFlashTrigger/ 执行 make。
- 集成与调用：
  - 主控根据策略/外部命令切换黄闪并与时序模块协同。
- 测试要点：
  - 切入/切出原子性与安全性。
- 扩展点：
  - 与远端维护平台联动。

---

### 9.11 RailCrossControl（铁路道口）
- 功能：
  - 与铁路道口信号/栏杆联动，保障列车通过时的行车安全（拉全红/清退/保持）。
- 主要源文件：
  - rcc.c、rccs.c、rcc.h。
- 对外接口/关键数据：
  - 列车到达/通过事件、联动阶段、清退策略。
- 依赖关系：
  - DetectControl（道口信号/传感）、TimingControl、MainCont。
- 配置与参数：
  - 联动提前量、清退时间。
- 编译与产物：
  - Modules/RailCrossControl/ 执行 make。
- 集成与调用：
  - 主控在事件到达时升高优先级并覆盖常规时序。
- 测试要点：
  - 误报/漏报容错、恢复时序的平滑。
- 扩展点：
  - 与铁路系统接口标准化。

---

### 9.12 SelfAdaptControl（自适应控制）
- 功能：
  - 基于实时流量与历史统计，动态优化相序与绿配比，提升通行效率。
- 主要源文件：
  - sac.c、sacs.c、sacs.h。
- 对外接口/关键数据：
  - 流量估计、优化目标（延误/排队/通行量）、输出（相序/绿比微调）。
- 依赖关系：
  - DetectControl、TimingControl、Common、可能依赖历史数据存储。
- 配置与参数：
  - 优化周期、权重参数、上下限约束。
- 编译与产物：
  - Modules/SelfAdaptControl/ 执行 make。
- 集成与调用：
  - 主控周期性触发优化计算并应用到 TimingControl。
- 测试要点：
  - 收敛性、震荡抑制、与公交/行人策略的冲突解决。
- 扩展点：
  - 引入强化学习/预测模型（Brain 系列配合）。

---

### 9.13 SysOptimizeAdapt（系统自适应优化）
- 功能：
  - 在更高层面针对路口整体或路网局部做自适应优化。
- 主要源文件：
  - soa.c、soas.c、soas.h。
- 对外接口/关键数据：
  - 目标函数、约束、优化结果下发接口。
- 依赖关系：
  - DetectControl、TimingControl、MainCont。
- 配置与参数：
  - 策略权重、全局/局部优化选择。
- 编译与产物：
  - Modules/SysOptimizeAdapt/ 执行 make。
- 集成与调用：
  - 与主控同步优化周期和安全边界。
- 测试要点：
  - 效果评估与退避机制。
- 扩展点：
  - 联网协调优化。

---

### 9.14 SysOptimizeTiming（时序优化）
- 功能：
  - 针对特定指标（延误、排队、通行量）离线/在线优化时序参数。
- 主要源文件：
  - sot.c、sots.c、sot.h。
- 对外接口/关键数据：
  - 时序参数集合、目标/约束、优化求解接口。
- 依赖关系：
  - TimingControl、DetectControl、Common。
- 配置与参数：
  - 优化时间窗、边界约束。
- 编译与产物：
  - Modules/SysOptimizeTiming/ 执行 make。
- 集成与调用：
  - 由主控在合适窗口应用新参数并管理回滚。
- 测试要点：
  - 新旧参数切换安全性与收益评估。
- 扩展点：
  - 与自适应/协调联合目标。

---

### 9.15 InterGratedControl（一体化控制）
- 功能：
  - 将多策略在统一框架下编排，支持跨模块联动与冲突裁决。
- 主要源文件：
  - igc.c、igcs.c、igc.h、igcs.h。
- 对外接口/关键数据：
  - 策略注册、优先级与冲突矩阵、裁决结果。
- 依赖关系：
  - MainCont、各策略模块。
- 配置与参数：
  - 策略优先级、冲突表。
- 编译与产物：
  - Modules/InterGratedControl/ 执行 make。
- 集成与调用：
  - 主控将策略请求汇总后交由一体化模块裁决。
- 测试要点：
  - 冲突消解正确性、在多策略高压场景下的稳定性。
- 扩展点：
  - 动态优先级、策略沙箱化。

---

### 9.16 CoordingDetect（协调检测）
- 功能：
  - 面向干道/绿波的协调检测与参数采集，服务于协调/优化策略。
- 主要源文件：
  - cd.c、cds.c、cd.h。
- 对外接口/关键数据：
  - 协调相关指标、数据上报接口。
- 依赖关系：
  - DetectControl、TimingControl。
- 配置与参数：
  - 协调带宽、偏移估计参数。
- 编译与产物：
  - Modules/CoordingDetect/ 执行 make。
- 集成与调用：
  - 作为数据提供方服务于协调/优化模块。
- 测试要点：
  - 偏移估计准确性、采集稳定性。
- 扩展点：
  - 与路网级控制对接。

---

### 9.17 SameControl（同向控制）
- 功能：
  - 针对同向放行的特殊编排与控制策略。
- 主要源文件：
  - sc.c、scs.c、scs.h。
- 对外接口/关键数据：
  - 同向相位定义、放行条件。
- 依赖关系：
  - TimingControl、Common。
- 配置与参数：
  - 放行时间窗、相邻相位关系。
- 编译与产物：
  - Modules/SameControl/ 执行 make。
- 集成与调用：
  - 主控根据场景激活同向策略。
- 测试要点：
  - 与行人/非机动车冲突、相间安全。
- 扩展点：
  - 与协调/优化联合约束。

---

### 9.18 GreenTrigger（绿触发）
- 功能：
  - 基于检测/规则的“绿波/绿触发”策略，减少启动延迟。
- 主要源文件：
  - gt.c、gts.c、gts.h。
- 对外接口/关键数据：
  - 触发条件、延长量、冷却时间。
- 依赖关系：
  - DetectControl、TimingControl。
- 配置与参数：
  - 触发阈值、最大延长。
- 编译与产物：
  - Modules/GreenTrigger/ 执行 make。
- 集成与调用：
  - 主控按需启用并与其他优先策略协同。
- 测试要点：
  - 误触发控制、对交叉方向影响评估。
- 扩展点：
  - 与公交优先/自适应的策略融合。

---

### 9.19 CycleRoadControl（环路控制）
- 功能：
  - 面向环路/特殊路权场景的控制策略。
- 主要源文件：
  - crc.c、crcs.c、crc.h。
- 对外接口/关键数据：
  - 环路阶段、触发条件。
- 依赖关系：
  - TimingControl、DetectControl。
- 配置与参数：
  - 环路参数与阈值。
- 编译与产物：
  - Modules/CycleRoadControl/ 执行 make。
- 集成与调用：
  - 主控结合场景触发。
- 测试要点：
  - 稳定性与安全性。
- 扩展点：
  - 与协调/优化融合。

---

### 9.20 MajorSalveControl（主路从属控制）
- 功能：
  - 针对主路与从属关系的特殊检测/控制（目录内文件命名为 dc.c/dcs.c/dcs.h，可能为检测控制的派生）。
- 主要源文件：
  - dc.c、dcs.c、dcs.h。
- 对外接口/关键数据：
  - 主从关系、触发/抑制条件。
- 依赖关系：
  - DetectControl、TimingControl、Common。
- 配置与参数：
  - 主从权重、切换阈值。
- 编译与产物：
  - Modules/MajorSalveControl/ 执行 make。
- 集成与调用：
  - 主控按需加载与裁决。
- 测试要点：
  - 与半感应/公交优先的冲突管理。
- 扩展点：
  - 与自适应策略融合。

---

### 9.21 BrainSelfAdapt / 9.22 BrainPersonPassStreet（Brain 系列）
- 功能：
  - 更高阶的“智能策略”原型/强化实现（如预测/学习驱动）。
- 主要源文件：
  - 对应目录下的 bsa.c/bsas.c、以及行人 Brain 相关源码（如存在）。
- 对外接口/关键数据：
  - 策略评估接口、学习状态。
- 依赖关系：
  - DetectControl、TimingControl、Common、可能依赖外部数据源。
- 配置与参数：
  - 学习率/权重、约束边界。
- 编译与产物：
  - 各自目录执行 make。
- 集成与调用：
  - 与主控/一体化控制配合，作为建议或直接控制源。
- 测试要点：
  - 收敛与安全边界控制。
- 扩展点：
  - 引入模型推理/在线学习框架。

---

### 9.23 SysOptimizeCoordinate（系统协调优化）
- 说明：
  - 当前仓库中仅见目录名（若存在），如需启用请按本模板补齐源码与接口；功能定位为路网协调（偏移/带宽）优化。

---

### 9.24 其他辅助脚本与批构建（compile.sh）
- 功能：
  - 批量进入各模块目录执行构建/清理，并收集产物至 Bin/。
- 主要文件：
  - Modules/compile.sh（已存在，包含按顺序进入子目录的命令，如 `cd ./TimingControl` 等）。
- 使用建议：
  - 按依赖顺序组织：Common/基础 → 策略模块 → MainCont → 复制产物到 Bin/；对每步增加错误处理与日志输出。

---

以上分章为当前目录结构与文件名基础上的技术文档框架。后续可在每个模块内进一步补充：
- 接口函数清单（函数名/参数/返回/调用方）
- 关键状态机（进入/退出条件、状态转移图）
- 性能指标（周期耗时、内存占用、吞吐）
- 与硬件/外设接口细节（GPIO/CAN/串口等）